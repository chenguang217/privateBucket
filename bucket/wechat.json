{
	"homepage": "https://pc.weixin.qq.com/",
	"description": "Free messaging and calling app.",
	"version": "3.9.2.23",
	"license": {
		"identifier": "EULA",
		"url": "https://weixin.qq.com/cgi-bin/readtemplate?lang=zh_CN&t=weixin_agreement&s=default"
	},
	"url": [
		"https://webcdn.m.qq.com/spcmgr/download/WeChat3.9.2.23.exe#/dl.7z",
		"https://raw.githubusercontent.com/chenguang217/bucketFiles/main/wechatStart.py"
	],
	"shortcuts": [
		[
			"start.vbs",
			"WeChat",
			"",
			"wechat.exe"
		]
	],
	"post_install": [
		"Remove-Item \"$dir\\`$PLUGINSDIR\" -Force -Recurse",
		"Remove-Item \"$dir\\`$_15_\" -Force -Recurse",
		"Remove-Item \"$dir\\`$R5\" -Force -Recurse"
	],
	"installer": {
		"script": [
			"pip install psutil requests xmltodict configparser",
			"if (!(Test-Path \"$persist_dir\\config.ini\")) { '[baseconf]' | out-file -append $dir\\config.ini -encoding ascii;'persist=' + $persist_dir | out-file -append $dir\\config.ini -encoding ascii;'dir=' + $dir | out-file -append $dir\\config.ini -encoding ascii }",
			"'set ws=WScript.CreateObject(\"WScript.Shell\")' | out-file -append $dir\\start.vbs -encoding ascii",
			"$python = $scoopdir.toString() + \"\\shims\\python.exe\" -replace \"\\\\\", \"\\\\\"",
			"$script = $dir.toString() + \"\\wechatStart.py\" -replace \"\\\\\", \"\\\\\"",
			"'ws.Run \"python ' + $script + '\",0' | out-file -append $dir\\start.vbs -encoding ascii",
			"'$triggers = @()' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$CIMTriggerClass = Get-CimClass -ClassName MSFT_TaskEventTrigger -Namespace Root/Microsoft/Windows/TaskScheduler:MSFT_TaskEventTrigger' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$trigger = New-CimInstance -CimClass $CIMTriggerClass -ClientOnly' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$trigger.Subscription = \"<QueryList><Query Id=`\"0`\" Path=`\"System`\"><Select Path=`\"System`\">*[System[Provider[@Name=' + \"'Microsoft-Windows-Kernel-Power'] and EventID=42]]</Select></Query></QueryList>\" + '\"' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$trigger.Enabled = $True' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$triggers += $trigger' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$CIMTriggerClass = Get-CimClass -ClassName MSFT_TaskEventTrigger -Namespace Root/Microsoft/Windows/TaskScheduler:MSFT_TaskEventTrigger' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$trigger = New-CimInstance -CimClass $CIMTriggerClass -ClientOnly' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$trigger.Subscription = \"<QueryList><Query Id=`\"0`\" Path=`\"System`\"><Select Path=`\"System`\">*[System[Provider[@Name=' + \"'Microsoft-Windows-Kernel-Power'] and EventID=1074]]</Select></Query></QueryList>\" + '\"' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$trigger.Enabled = $True' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$triggers += $trigger' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$User=\"Nt Authority\\System\"' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$Action=New-ScheduledTaskAction -Execute \"cmd.exe\" -Argument \"/c taskkill /f /im WeChat.exe\"' | out-file -append $dir\\register.ps1 -encoding ascii",
			"\"Register-ScheduledTask -TaskName 'WeChat Shutdown' -Trigger `$triggers -User `$User -Action `$Action -RunLevel Highest -Force\" | out-file -append $dir\\register.ps1 -encoding ascii",
			"start-process powershell -ArgumentList \"-noprofile -file $dir\\register.ps1\" -verb RunAs -WindowStyle hidden -wait",
			"if (Test-Path \"$persist_dir\\WeChat\") {",
			"    Remove-Item \"$env:APPDATA\\Tencent\\WeChat\" -Force -Recurse -ErrorAction SilentlyContinue",
			"    if (!(Test-Path \"$persist_dir\\WeChat\\1\")) {",
			"        mkdir \"$persist_dir\\WeChat\\1\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\1\" -Target \"$persist_dir\\WeChat\\1\" | Out-Null",
			"    if (!(Test-Path \"$persist_dir\\WeChat\\All Users\")) {",
			"        mkdir \"$persist_dir\\WeChat\\All Users\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\All Users\" -Target \"$persist_dir\\WeChat\\All Users\" | Out-Null",
			"    if (!(Test-Path \"$persist_dir\\WeChat\\bak\")) {",
			"        mkdir \"$persist_dir\\WeChat\\bak\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\bak\" -Target \"$persist_dir\\WeChat\\bak\" | Out-Null",
			"    if (!(Test-Path \"$persist_dir\\WeChat\\cdncomm\")) {",
			"        mkdir \"$persist_dir\\WeChat\\cdncomm\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\cdncomm\" -Target \"$persist_dir\\WeChat\\cdncomm\" | Out-Null",
			"    if (!(Test-Path \"$persist_dir\\WeChat\\log\")) {",
			"        mkdir \"$persist_dir\\WeChat\\log\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\log\" -Target \"$persist_dir\\WeChat\\log\" | Out-Null",
			"    if (!(Test-Path \"$persist_dir\\WeChat\\xweb\")) {",
			"        mkdir \"$persist_dir\\WeChat\\xweb\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\xweb\" -Target \"$persist_dir\\WeChat\\xweb\" | Out-Null",
			"    if (!(Test-Path \"$persist_dir\\WeChat\\XPlugin\\Info\")) {",
			"        mkdir \"$persist_dir\\WeChat\\XPlugin\\Info\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Info\" -Target \"$persist_dir\\WeChat\\XPlugin\\Info\" | Out-Null",
			"    if (!(Test-Path \"$persist_dir\\WeChat\\XPlugin\\Plugins\\CourgettePatch\")) {",
			"        mkdir \"$persist_dir\\WeChat\\XPlugin\\Plugins\\CourgettePatch\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\CourgettePatch\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\CourgettePatch\" | Out-Null",
			"    if (!(Test-Path \"$persist_dir\\WeChat\\XPlugin\\Plugins\\FinderLive\")) {",
			"        mkdir \"$persist_dir\\WeChat\\XPlugin\\Plugins\\FinderLive\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\FinderLive\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\FinderLive\" | Out-Null",
			"    if (!(Test-Path \"$persist_dir\\WeChat\\XPlugin\\Plugins\\RadiumWMPF\")) {",
			"        mkdir \"$persist_dir\\WeChat\\XPlugin\\Plugins\\RadiumWMPF\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\RadiumWMPF\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\RadiumWMPF\" | Out-Null",
			"    if (!(Test-Path \"$persist_dir\\WeChat\\XPlugin\\Plugins\\ThumbPlayer\")) {",
			"        mkdir \"$persist_dir\\WeChat\\XPlugin\\Plugins\\ThumbPlayer\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\ThumbPlayer\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\ThumbPlayer\" | Out-Null",
			"    if (!(Test-Path \"$persist_dir\\WeChat\\XPlugin\\Plugins\\UpdateNotify\")) {",
			"        mkdir \"$persist_dir\\WeChat\\XPlugin\\Plugins\\UpdateNotify\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\UpdateNotify\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\UpdateNotify\" | Out-Null",
			"    if (!(Test-Path \"$persist_dir\\WeChat\\XPlugin\\Plugins\\WeChatOCR\")) {",
			"        mkdir \"$persist_dir\\WeChat\\XPlugin\\Plugins\\WeChatOCR\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\WeChatOCR\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\WeChatOCR\" | Out-Null",
			"    if (!(Test-Path \"$persist_dir\\WeChat\\XPlugin\\Plugins\\WeChatUpdate\")) {",
			"        mkdir \"$persist_dir\\WeChat\\XPlugin\\Plugins\\WeChatUpdate\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\WeChatUpdate\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\WeChatUpdate\" | Out-Null",
			"    if (!(Test-Path \"$persist_dir\\WeChat\\XPlugin\\Plugins\\XFilesOfficeReader\")) {",
			"        mkdir \"$persist_dir\\WeChat\\XPlugin\\Plugins\\XFilesOfficeReader\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\XFilesOfficeReader\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\XFilesOfficeReader\" | Out-Null",
			"    if (!(Test-Path \"$persist_dir\\WeChat\\XPlugin\\Plugins\\XWeb\")) {",
			"        mkdir \"$persist_dir\\WeChat\\XPlugin\\Plugins\\XWeb\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\XWeb\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\XWeb\" | Out-Null",
			"    if ((Test-Path \"$persist_dir\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\")) {",
			"        $wmpfruntime = get-childitem \"$persist_dir\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\"",
			"        foreach($wmpf in $wmpfruntime){",
			"            $wmpflocation = \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\\\" + $wmpf.name + \"\\extracted\"",
			"            $wmpftarget = \"$persist_dir\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\\\" + $wmpf.name + \"\\extracted\"",
			"            New-Item -Type Junction -Path $wmpflocation -Target $wmpftarget | Out-Null",
			"        }",
			"    }",
			"} else {",
			"    if (Test-Path \"$env:APPDATA\\Tencent\\WeChat\") {",
			"        Move-Item \"$env:APPDATA\\Tencent\\WeChat\" \"$persist_dir\\WeChat\" -Force",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\1\" -Target \"$persist_dir\\WeChat\\1\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\All Users\" -Target \"$persist_dir\\WeChat\\All Users\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\bak\" -Target \"$persist_dir\\WeChat\\bak\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\cdn\" -Target \"$persist_dir\\WeChat\\cdn\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\log\" -Target \"$persist_dir\\WeChat\\log\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\wmpf\" -Target \"$persist_dir\\WeChat\\wmpf\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\xweb\" -Target \"$persist_dir\\WeChat\\xweb\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Info\" -Target \"$persist_dir\\WeChat\\XPlugin\\Info\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\CourgettePatch\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\CourgettePatch\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\FinderLive\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\FinderLive\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\RadiumWMPF\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\RadiumWMPF\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\ThumbPlayer\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\ThumbPlayer\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\UpdateNotify\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\UpdateNotify\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\WeChatOCR\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\WeChatOCR\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\WeChatUpdate\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\WeChatUpdate\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\XFilesOfficeReader\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\XFilesOfficeReader\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\XWeb\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\XWeb\" | Out-Null",
			"    }",
			"}"
		]
	},
	"uninstaller": {
		"script": [
			"Start-Process powershell \"unregister-scheduledtask -taskname 'WeChat Shutdown' -confirm:`$false\" -Verb RunAs -WindowStyle hidden -wait",
			"if (!(Test-Path \"$persist_dir\\WeChat\\All Users\")) {",
			"    Move-Item \"$env:APPDATA\\Tencent\\WeChat\" \"$persist_dir\\WeChat\" -Force",
			"} else {",
			"    Remove-Item \"$env:APPDATA\\Tencent\\WeChat\" -Force -Recurse -ErrorAction SilentlyContinue",
			"}"
		]
	},
	"checkver": "<span class=\"download-version\">([\\d.]+)</span>",
	"autoupdate": {
		"url": "https://dldir1.qq.com/weixin/Windows/WeChatSetup.exe#/dl.7z"
	},
	"persist": "WeChat",
	"hash": [
		"md5:17a215a93b3b24741fb2f4356b94654d",
		"md5:7478499393cd77fc0794bca9b2d7e8df"
	]
}