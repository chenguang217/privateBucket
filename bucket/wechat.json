{
	"homepage": "https://pc.weixin.qq.com/",
	"description": "Free messaging and calling app.",
	"version": "3.8.0",
	"license": {
		"identifier": "EULA",
		"url": "https://weixin.qq.com/cgi-bin/readtemplate?lang=zh_CN&t=weixin_agreement&s=default"
	},
	"url": "https://dldir1.qq.com/weixin/Windows/WeChatSetup.exe#/dl.7z",
	"shortcuts": [
		[
			"start.vbs",
			"WeChat",
			"",
			"wechat.exe"
		]
	],
	"post_install": [
		"Remove-Item \"$dir\\`$PLUGINSDIR\" -Force -Recurse",
		"Remove-Item \"$dir\\`$_15_\" -Force -Recurse",
		"Remove-Item \"$dir\\`$R5\" -Force -Recurse"
	],
	"installer": {
		"script": [
			"pip install psutil",
			"'import os,subprocess,time,psutil' | out-file -append $dir\\start.py -encoding ascii",
			"'def judgeprocess(processname):' | out-file -append $dir\\start.py -encoding ascii",
			"'    try:' | out-file -append $dir\\start.py -encoding ascii",
			"'        pl = psutil.pids()' | out-file -append $dir\\start.py -encoding ascii",
			"'        for pid in pl:' | out-file -append $dir\\start.py -encoding ascii",
			"'            if psutil.Process(pid).name() == processname:' | out-file -append $dir\\start.py -encoding ascii",
			"'                return 0' | out-file -append $dir\\start.py -encoding ascii",
			"'        else:' | out-file -append $dir\\start.py -encoding ascii",
			"'            return 1' | out-file -append $dir\\start.py -encoding ascii",
			"'    except:' | out-file -append $dir\\start.py -encoding ascii",
			"'        return 0' | out-file -append $dir\\start.py -encoding ascii",
			"'state = 0' | out-file -append $dir\\start.py -encoding ascii",
			"'wechat = r\"' + $dir + '\\WeChat.exe\"' | out-file -append $dir\\start.py -encoding ascii",
			"'if not os.path.exists(r\"' + $persist_dir + '\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\"):' | out-file -append $dir\\start.py -encoding ascii",
			"'    os.makedirs(r\"' + $persist_dir + '\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\\4620\")' | out-file -append $dir\\start.py -encoding ascii",
			"'if not os.path.exists(os.environ.get(\"APPDATA\") + r\"\\Tencent\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\"):' | out-file -append $dir\\start.py -encoding ascii",
			"'    os.makedirs(os.environ.get(\"APPDATA\") + r\"\\Tencent\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\")' | out-file -append $dir\\start.py -encoding ascii",
			"'dir_list = sorted(os.listdir(r\"' + $persist_dir + '\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\"),  key=lambda x: os.path.getmtime(os.path.join(r\"' + $persist_dir + '\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\", x)), reverse=True)' | out-file -append $dir\\start.py -encoding ascii",
			"'dir_list2 = sorted(os.listdir(os.environ.get(\"APPDATA\") + r\"\\Tencent\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\"),  key=lambda x: os.path.getmtime(os.path.join(os.environ.get(\"APPDATA\") + r\"\\Tencent\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\", x)), reverse=True)' | out-file -append $dir\\start.py -encoding ascii",
			"'flag = False' | out-file -append $dir\\start.py -encoding ascii",
			"'for director in dir_list2:' | out-file -append $dir\\start.py -encoding ascii",
			"'    if os.path.exists(os.path.join(os.environ.get(\"APPDATA\") + r\"\\Tencent\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\", director + r\"\\extracted\")):' | out-file -append $dir\\start.py -encoding ascii",
			"'        try:' | out-file -append $dir\\start.py -encoding ascii",
			"'            if os.readlink(os.path.join(os.environ.get(\"APPDATA\") + r\"\\Tencent\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\", director + r\"\\extracted\")) == os.path.join(r\"\\\\?\\' + $persist_dir + '\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\", dir_list[0] + r\"\\extracted\"):' | out-file -append $dir\\start.py -encoding ascii",
			"'                if flag:' | out-file -append $dir\\start.py -encoding ascii",
			"'                    os.system(r\"rmdir /S /Q %APPDATA%\\Tencent\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\\\\\" + director)' | out-file -append $dir\\start.py -encoding ascii",
			"'                else:' | out-file -append $dir\\start.py -encoding ascii",
			"'                    print(\"nothing to do\", director)' | out-file -append $dir\\start.py -encoding ascii",
			"'        except:' | out-file -append $dir\\start.py -encoding ascii",
			"'            flag = True' | out-file -append $dir\\start.py -encoding ascii",
			"'            print(\"need update\", director)' | out-file -append $dir\\start.py -encoding ascii",
			"'            os.system(r\"rmdir /S /Q ' + $persist_dir + '\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\\\\\" + dir_list[0])' | out-file -append $dir\\start.py -encoding ascii",
			"\"            os.system(r'powershell.exe `\"Move-Item `$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\\\\' + director + ' \" + $persist_dir + \"\\WeChat\\XPlugin\\Plugins\\WMPFRuntime`\"')\" | out-file -append $dir\\start.py -encoding ascii",
			"\"            os.system(r'powershell.exe `\"New-Item -Type Junction -Path `$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\\\\' + director + r'\\extracted -Target \" + $persist_dir + \"\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\\\\' + director + r'\\extracted`\"')\" | out-file -append $dir\\start.py -encoding ascii",
			"'    else:' | out-file -append $dir\\start.py -encoding ascii",
			"'        print(\"need delete\", director)' | out-file -append $dir\\start.py -encoding ascii",
			"'        os.system(r\"rmdir /S /Q ' + $persist_dir + '\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\\\\\" + dir_list[0])' | out-file -append $dir\\start.py -encoding ascii",
			"'subprocess.Popen(wechat)' | out-file -append $dir\\start.py -encoding ascii",
			"'times = 0' | out-file -append $dir\\start.py -encoding ascii",
			"'while True:' | out-file -append $dir\\start.py -encoding ascii",
			"\"    process_name='LogonUI.exe'\" | out-file -append $dir\\start.py -encoding ascii",
			"\"    callall='TASKLIST'\" | out-file -append $dir\\start.py -encoding ascii",
			"'    outputall=subprocess.check_output(callall)' | out-file -append $dir\\start.py -encoding ascii",
			"'    outputstringall=str(outputall)' | out-file -append $dir\\start.py -encoding ascii",
			"'    if process_name in outputstringall:' | out-file -append $dir\\start.py -encoding ascii",
			"'        print(\"Locked.\")' | out-file -append $dir\\start.py -encoding ascii",
			"'        if state == 0 and times >= 120:' | out-file -append $dir\\start.py -encoding ascii",
			"'            state = 1' | out-file -append $dir\\start.py -encoding ascii",
			"\"            os.system('taskkill /F /IM `\"WeChat.exe`\"')\" | out-file -append $dir\\start.py -encoding ascii",
			"'        elif times < 120:' | out-file -append $dir\\start.py -encoding ascii",
			"'            times += 1' | out-file -append $dir\\start.py -encoding ascii",
			"'    else:' | out-file -append $dir\\start.py -encoding ascii",
			"'        print(\"Unlocked.\")' | out-file -append $dir\\start.py -encoding ascii",
			"'        if state == 1:' | out-file -append $dir\\start.py -encoding ascii",
			"'            state = 0' | out-file -append $dir\\start.py -encoding ascii",
			"'            times = 0' | out-file -append $dir\\start.py -encoding ascii",
			"'            if not os.path.exists(r\"' + $persist_dir + '\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\"):' | out-file -append $dir\\start.py -encoding ascii",
			"'                os.makedirs(r\"' + $persist_dir + '\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\\4620\")' | out-file -append $dir\\start.py -encoding ascii",
			"'            if not os.path.exists(os.environ.get(\"APPDATA\") + r\"\\Tencent\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\"):' | out-file -append $dir\\start.py -encoding ascii",
			"'                os.makedirs(os.environ.get(\"APPDATA\") + r\"\\Tencent\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\")' | out-file -append $dir\\start.py -encoding ascii",
			"'            dir_list = sorted(os.listdir(r\"' + $persist_dir + '\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\"),  key=lambda x: os.path.getmtime(os.path.join(r\"' + $persist_dir + '\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\", x)), reverse=True)' | out-file -append $dir\\start.py -encoding ascii",
			"'            dir_list2 = sorted(os.listdir(os.environ.get(\"APPDATA\") + r\"\\Tencent\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\"),  key=lambda x: os.path.getmtime(os.path.join(os.environ.get(\"APPDATA\") + r\"\\Tencent\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\", x)), reverse=True)' | out-file -append $dir\\start.py -encoding ascii",
			"'            flag = False' | out-file -append $dir\\start.py -encoding ascii",
			"'            for director in dir_list2:' | out-file -append $dir\\start.py -encoding ascii",
			"'                if os.path.exists(os.path.join(os.environ.get(\"APPDATA\") + r\"\\Tencent\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\", director + r\"\\extracted\")):' | out-file -append $dir\\start.py -encoding ascii",
			"'                    try:' | out-file -append $dir\\start.py -encoding ascii",
			"'                        if os.readlink(os.path.join(os.environ.get(\"APPDATA\") + r\"\\Tencent\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\", director + r\"\\extracted\")) == os.path.join(r\"\\\\?\\' + $persist_dir + '\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\", dir_list[0] + r\"\\extracted\"):' | out-file -append $dir\\start.py -encoding ascii",
			"'                            if flag:' | out-file -append $dir\\start.py -encoding ascii",
			"'                                os.system(r\"rmdir /S /Q %APPDATA%\\Tencent\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\\\\\" + director)' | out-file -append $dir\\start.py -encoding ascii",
			"'                            else:' | out-file -append $dir\\start.py -encoding ascii",
			"'                                print(\"nothing to do\", director)' | out-file -append $dir\\start.py -encoding ascii",
			"'                    except:' | out-file -append $dir\\start.py -encoding ascii",
			"'                        flag = True' | out-file -append $dir\\start.py -encoding ascii",
			"'                        print(\"need update\", director)' | out-file -append $dir\\start.py -encoding ascii",
			"'                        os.system(r\"rmdir /S /Q ' + $persist_dir + '\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\\\\\" + dir_list[0])' | out-file -append $dir\\start.py -encoding ascii",
			"\"                        os.system(r'powershell.exe `\"Move-Item `$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\\\\' + director + ' \" + $persist_dir + \"\\WeChat\\XPlugin\\Plugins\\WMPFRuntime`\"')\" | out-file -append $dir\\start.py -encoding ascii",
			"\"                        os.system(r'powershell.exe `\"New-Item -Type Junction -Path `$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\\\\' + director + r'\\extracted -Target \" + $persist_dir + \"\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\\\\' + director + r'\\extracted`\"')\" | out-file -append $dir\\start.py -encoding ascii",
			"'                else:' | out-file -append $dir\\start.py -encoding ascii",
			"'                    print(\"need delete\", director)' | out-file -append $dir\\start.py -encoding ascii",
			"'                    os.system(r\"rmdir /S /Q ' + $persist_dir + '\\WeChat\\XPlugin\\Plugins\\WMPFRuntime\\\\\" + dir_list[0])' | out-file -append $dir\\start.py -encoding ascii",
			"'            subprocess.Popen(wechat)' | out-file -append $dir\\start.py -encoding ascii",
			"\"        elif judgeprocess('WeChat.exe') == 1:\" | out-file -append $dir\\start.py -encoding ascii",
			"'            exit()' | out-file -append $dir\\start.py -encoding ascii",
			"'    time.sleep(5)' | out-file -append $dir\\start.py -encoding ascii",
			"'set ws=WScript.CreateObject(\"WScript.Shell\")' | out-file -append $dir\\start.vbs -encoding ascii",
			"$python = $scoopdir.toString() + \"\\shims\\python.exe\" -replace \"\\\\\", \"\\\\\"",
			"$script = $dir.toString() + \"\\start.py\" -replace \"\\\\\", \"\\\\\"",
			"'ws.Run \"python ' + $script + '\",0' | out-file -append $dir\\start.vbs -encoding ascii",
			"'$triggers = @()' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$CIMTriggerClass = Get-CimClass -ClassName MSFT_TaskEventTrigger -Namespace Root/Microsoft/Windows/TaskScheduler:MSFT_TaskEventTrigger' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$trigger = New-CimInstance -CimClass $CIMTriggerClass -ClientOnly' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$trigger.Subscription = \"<QueryList><Query Id=`\"0`\" Path=`\"System`\"><Select Path=`\"System`\">*[System[Provider[@Name=' + \"'Microsoft-Windows-Kernel-Power'] and EventID=42]]</Select></Query></QueryList>\" + '\"' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$trigger.Enabled = $True' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$triggers += $trigger' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$CIMTriggerClass = Get-CimClass -ClassName MSFT_TaskEventTrigger -Namespace Root/Microsoft/Windows/TaskScheduler:MSFT_TaskEventTrigger' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$trigger = New-CimInstance -CimClass $CIMTriggerClass -ClientOnly' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$trigger.Subscription = \"<QueryList><Query Id=`\"0`\" Path=`\"System`\"><Select Path=`\"System`\">*[System[Provider[@Name=' + \"'Microsoft-Windows-Kernel-Power'] and EventID=1074]]</Select></Query></QueryList>\" + '\"' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$trigger.Enabled = $True' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$triggers += $trigger' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$User=\"Nt Authority\\System\"' | out-file -append $dir\\register.ps1 -encoding ascii",
			"'$Action=New-ScheduledTaskAction -Execute \"cmd.exe\" -Argument \"/c taskkill /f /im WeChat.exe\"' | out-file -append $dir\\register.ps1 -encoding ascii",
			"\"Register-ScheduledTask -TaskName 'WeChat Shutdown' -Trigger `$triggers -User `$User -Action `$Action -RunLevel Highest -Force\" | out-file -append $dir\\register.ps1 -encoding ascii",
			"start-process powershell -ArgumentList \"-noprofile -file $dir\\register.ps1\" -verb RunAs -WindowStyle hidden -wait",
			"if (Test-Path \"$persist_dir\\WeChat\") {",
			"    Remove-Item \"$env:APPDATA\\Tencent\\WeChat\" -Force -Recurse -ErrorAction SilentlyContinue",
			"    if (!Test-Path \"$persist_dir\\WeChat\\1\") {",
			"        mkdir \"$persist_dir\\WeChat\\1\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\1\" -Target \"$persist_dir\\WeChat\\1\" | Out-Null",
			"    if (!Test-Path \"$persist_dir\\WeChat\\All Users\") {",
			"        mkdir \"$persist_dir\\WeChat\\All Users\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\All Users\" -Target \"$persist_dir\\WeChat\\All Users\" | Out-Null",
			"    if (!Test-Path \"$persist_dir\\WeChat\\bak\") {",
			"        mkdir \"$persist_dir\\WeChat\\bak\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\bak\" -Target \"$persist_dir\\WeChat\\bak\" | Out-Null",
			"    if (!Test-Path \"$persist_dir\\WeChat\\cdncomm\") {",
			"        mkdir \"$persist_dir\\WeChat\\cdncomm\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\cdncomm\" -Target \"$persist_dir\\WeChat\\cdncomm\" | Out-Null",
			"    if (!Test-Path \"$persist_dir\\WeChat\\log\") {",
			"        mkdir \"$persist_dir\\WeChat\\log\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\log\" -Target \"$persist_dir\\WeChat\\log\" | Out-Null",
			"    if (!Test-Path \"$persist_dir\\WeChat\\wmpf_app\") {",
			"        mkdir \"$persist_dir\\WeChat\\wmpf_app\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\wmpf_app\" -Target \"$persist_dir\\WeChat\\wmpf_app\" | Out-Null",
			"    if (!Test-Path \"$persist_dir\\WeChat\\xweb\") {",
			"        mkdir \"$persist_dir\\WeChat\\xweb\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\xweb\" -Target \"$persist_dir\\WeChat\\xweb\" | Out-Null",
			"    if (!Test-Path \"$persist_dir\\WeChat\\XPlugin\\Info\") {",
			"        mkdir \"$persist_dir\\WeChat\\XPlugin\\Info\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Info\" -Target \"$persist_dir\\WeChat\\XPlugin\\Info\" | Out-Null",
			"    if (!Test-Path \"$persist_dir\\WeChat\\XPlugin\\Plugins\\CourgettePatch\") {",
			"        mkdir \"$persist_dir\\WeChat\\XPlugin\\Plugins\\CourgettePatch\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\CourgettePatch\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\CourgettePatch\" | Out-Null",
			"    if (!Test-Path \"$persist_dir\\WeChat\\XPlugin\\Plugins\\FinderLive\") {",
			"        mkdir \"$persist_dir\\WeChat\\XPlugin\\Plugins\\FinderLive\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\FinderLive\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\FinderLive\" | Out-Null",
			"    if (!Test-Path \"$persist_dir\\WeChat\\XPlugin\\Plugins\\RadiumWMPF\") {",
			"        mkdir \"$persist_dir\\WeChat\\XPlugin\\Plugins\\RadiumWMPF\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\RadiumWMPF\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\RadiumWMPF\" | Out-Null",
			"    if (!Test-Path \"$persist_dir\\WeChat\\XPlugin\\Plugins\\ThumbPlayer\") {",
			"        mkdir \"$persist_dir\\WeChat\\XPlugin\\Plugins\\ThumbPlayer\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\ThumbPlayer\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\ThumbPlayer\" | Out-Null",
			"    if (!Test-Path \"$persist_dir\\WeChat\\XPlugin\\Plugins\\UpdateNotify\") {",
			"        mkdir \"$persist_dir\\WeChat\\XPlugin\\Plugins\\UpdateNotify\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\UpdateNotify\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\UpdateNotify\" | Out-Null",
			"    if (!Test-Path \"$persist_dir\\WeChat\\XPlugin\\Plugins\\WeChatOCR\") {",
			"        mkdir \"$persist_dir\\WeChat\\XPlugin\\Plugins\\WeChatOCR\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\WeChatOCR\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\WeChatOCR\" | Out-Null",
			"    if (!Test-Path \"$persist_dir\\WeChat\\XPlugin\\Plugins\\WeChatUpdate\") {",
			"        mkdir \"$persist_dir\\WeChat\\XPlugin\\Plugins\\WeChatUpdate\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\WeChatUpdate\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\WeChatUpdate\" | Out-Null",
			"    if (!Test-Path \"$persist_dir\\WeChat\\XPlugin\\Plugins\\XFilesOfficeReader\") {",
			"        mkdir \"$persist_dir\\WeChat\\XPlugin\\Plugins\\XFilesOfficeReader\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\XFilesOfficeReader\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\XFilesOfficeReader\" | Out-Null",
			"    if (!Test-Path \"$persist_dir\\WeChat\\XPlugin\\Plugins\\XWeb\") {",
			"        mkdir \"$persist_dir\\WeChat\\XPlugin\\Plugins\\XWeb\"",
			"    }",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\XWeb\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\XWeb\" | Out-Null",
			"} else {",
			"    if (Test-Path \"$env:APPDATA\\Tencent\\WeChat\") {",
			"        Move-Item \"$env:APPDATA\\Tencent\\WeChat\" \"$persist_dir\\WeChat\" -Force",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\1\" -Target \"$persist_dir\\WeChat\\1\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\All Users\" -Target \"$persist_dir\\WeChat\\All Users\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\bak\" -Target \"$persist_dir\\WeChat\\bak\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\cdn\" -Target \"$persist_dir\\WeChat\\cdn\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\log\" -Target \"$persist_dir\\WeChat\\log\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\wmpf\" -Target \"$persist_dir\\WeChat\\wmpf\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\xweb\" -Target \"$persist_dir\\WeChat\\xweb\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Info\" -Target \"$persist_dir\\WeChat\\XPlugin\\Info\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\CourgettePatch\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\CourgettePatch\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\FinderLive\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\FinderLive\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\RadiumWMPF\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\RadiumWMPF\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\ThumbPlayer\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\ThumbPlayer\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\UpdateNotify\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\UpdateNotify\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\WeChatOCR\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\WeChatOCR\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\WeChatUpdate\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\WeChatUpdate\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\XFilesOfficeReader\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\XFilesOfficeReader\" | Out-Null",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\Tencent\\WeChat\\XPlugin\\Plugins\\XWeb\" -Target \"$persist_dir\\WeChat\\XPlugin\\Plugins\\XWeb\" | Out-Null",
			"    }",
			"}"
		]
	},
	"uninstaller": {
		"script": [
			"Start-Process powershell \"unregister-scheduledtask -taskname 'WeChat Shutdown' -confirm:`$false\" -Verb RunAs -WindowStyle hidden -wait",
			"if (!(Test-Path \"$persist_dir\\WeChat\\All Users\")) {",
			"    Move-Item \"$env:APPDATA\\Tencent\\WeChat\" \"$persist_dir\\WeChat\" -Force",
			"} else {",
			"    Remove-Item \"$env:APPDATA\\Tencent\\WeChat\" -Force -Recurse -ErrorAction SilentlyContinue",
			"}"
		]
	},
	"checkver": "<span class=\"download-version\">([\\d.]+)</span>",
	"autoupdate": {
		"url": "https://dldir1.qq.com/weixin/Windows/WeChatSetup.exe#/dl.7z"
	},
	"persist": "WeChat",
	"hash": "md5:75fc3fa72aa87a76ef5b4a99b5361fa0"
}