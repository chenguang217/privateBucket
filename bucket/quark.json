{
	"version": "3.2.3",
	"description": "client for Quark Netdisk",
	"homepage": "https://pan.quark.cn/",
	"url": "https://pdds.quark.cn/download/stfile/hhnkoiommhilhjpjz/QuarkCloudDrive_v3.2.3_release_(Build1770105-20240509201431).exe#/dl.exe",
	"hash": "e95aa2b8d050188a78ac4bbda67fdfbd337655d3d1c12a0ab2a232138c38fc99",
	"installer": {
		"script": [
			"innounp -x $dir\\dl.exe -d\"$dir\"",
			"Move-Item \"$dir\\{code_GetDestDir}\\*\" \"$dir\"",
			"Remove-Item \"$dir\\{code_GetDestDir}\" -Force -Recurse -ErrorAction SilentlyContinue",
			"Move-Item \"$dir\\{app}\\*\" \"$dir\"",
			"Remove-Item \"$dir\\{app}\" -Force -Recurse -ErrorAction SilentlyContinue",
			"Copy-Item \"$dir\\{usercf}\\*\" \"$env:LOCALAPPDATA\\Programs\\Common\"",
			"mkdir \"$env:LOCALAPPDATA\\Programs\\Common\\XDrive\"",
			"Move-Item \"$dir\\{usercf}\\*\" \"$env:LOCALAPPDATA\\Programs\\Common\\XDrive\"",
			"Remove-Item \"$dir\\{usercf}\" -Force -Recurse -ErrorAction SilentlyContinue",
			"Remove-Item \"$dir\\{tmp}\" -Force -Recurse -ErrorAction SilentlyContinue",
			"Remove-Item \"$dir\\{autocf64}\" -Force -Recurse -ErrorAction SilentlyContinue",
			"if (Test-Path \"$persist_dir\\quark-cloud-drive\") {",
			"    Remove-Item \"$env:APPDATA\\quark-cloud-drive\" -Force -Recurse -ErrorAction SilentlyContinue",
			"    New-Item -Type Junction -Path \"$env:APPDATA\\quark-cloud-drive\" -Target \"$persist_dir\\quark-cloud-drive\" | Out-Null",
			"} else {",
			"    if (Test-Path \"$env:APPDATA\\quark-cloud-drive\") {",
			"        Move-Item \"$env:APPDATA\\quark-cloud-drive\" \"$persist_dir\\quark-cloud-drive\" -Force",
			"        New-Item -Type Junction -Path \"$env:APPDATA\\quark-cloud-drive\" -Target \"$persist_dir\\quark-cloud-drive\" | Out-Null",
			"    }",
			"}",
			"\"start $dir\\startup2.vbs\" | out-file -append $dir/startup.bat -encoding ascii",
			"'timeout 5' | out-file -append $dir/startup.bat -encoding ascii",
			"'reg delete \"HKEY_CLASSES_ROOT\\*\\shell\\QuarkCloudDrive.upload\" /f' | out-file -append $dir/startup.bat -encoding ascii",
			"'reg delete \"HKEY_CLASSES_ROOT\\Directory\\shell\\QuarkCloudDrive.upload\" /f' | out-file -append $dir/startup.bat -encoding ascii",
			"'reg delete \"HKEY_CLASSES_ROOT\\Directory\\shell\\QuarkCloudDrive.backup\" /f' | out-file -append $dir/startup.bat -encoding ascii",
			"\"$dir\\QuarkCloudDrive.exe\" | out-file -append $dir/startup2.bat -encoding ascii",
			"'reg delete \"HKEY_CLASSES_ROOT\\*\\shell\\QuarkCloudDrive.upload\" /f' | out-file -append $dir/startup2.bat -encoding ascii",
			"'reg delete \"HKEY_CLASSES_ROOT\\Directory\\shell\\QuarkCloudDrive.upload\" /f' | out-file -append $dir/startup2.bat -encoding ascii",
			"'reg delete \"HKEY_CLASSES_ROOT\\Directory\\shell\\QuarkCloudDrive.backup\" /f' | out-file -append $dir/startup2.bat -encoding ascii",
			"'set ws=WScript.CreateObject(\"WScript.Shell\")' | out-file -append $dir/startup.vbs -encoding ascii",
			"$script = $dir.toString() + \"\\startup.bat\" -replace \"\\\\\", \"\\\\\"",
			"'ws.Run \"' + $script + '\",0' | out-file -append $dir\\startup.vbs -encoding ascii",
			"'set ws=WScript.CreateObject(\"WScript.Shell\")' | out-file -append $dir/startup2.vbs -encoding ascii",
			"$script = $dir.toString() + \"\\startup2.bat\" -replace \"\\\\\", \"\\\\\"",
			"'ws.Run \"' + $script + '\",0' | out-file -append $dir\\startup2.vbs -encoding ascii"
		]
	},
	"uninstaller": {
		"script": [
			"if (!(Test-Path \"$persist_dir\\quark-cloud-drive\")) {",
			"    Move-Item \"$env:APPDATA\\quark-cloud-drive\" \"$persist_dir\\quark-cloud-drive\" -Force",
			"} else {",
			"    Remove-Item \"$env:APPDATA\\quark-cloud-drive\" -Force -Recurse -ErrorAction SilentlyContinue",
			"}",
			"Remove-Item \"$env:LOCALAPPDATA\\Programs\\Common\\XDrive\" -Force -Recurse -ErrorAction SilentlyContinue",
			"Remove-Item \"$env:LOCALAPPDATA\\Programs\\Common\\xdrive.node\" -Force -Recurse -ErrorAction SilentlyContinue"
		]
	},
	"shortcuts": [
		[
			"startup.vbs",
			"\u5938\u514b\u7f51\u76d8",
			"",
			"QuarkCloudDrive.exe"
		]
	]
}